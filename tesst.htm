<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Basketball Throw</title>
    <style>
        body { margin: 0; overflow: hidden; background-color: #111; font-family: 'Arial', sans-serif; }
        
        /* UI ‡§î‡§∞ ‡§∏‡•ç‡§ï‡•ã‡§∞‡§¨‡•ã‡§∞‡•ç‡§° */
        #ui-layer {
            position: absolute; top: 20px; width: 100%; text-align: center;
            pointer-events: none; user-select: none;
        }
        h1 { color: white; margin: 0; text-transform: uppercase; letter-spacing: 2px; text-shadow: 0 0 10px #ff6600; }
        p { color: #ccc; font-size: 14px; }
        #score-board { font-size: 40px; color: #ffeb3b; font-weight: bold; margin-top: 10px; }
        
        /* ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡§®‡•á ‡§™‡§∞ ‡§ü‡§ö ‡§á‡§´‡•á‡§ï‡•ç‡§ü (Ripple) */
        .ripple {
            position: absolute; border-radius: 50%; transform: scale(0);
            background: rgba(255, 255, 255, 0.4);
            animation: ripple-anim 0.6s linear; pointer-events: none;
        }
        @keyframes ripple-anim {
            to { transform: scale(4); opacity: 0; }
        }
    </style>

    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>
</head>
<body>

    <div id="ui-layer">
        <h1>Click to Shoot! üèÄ</h1>
        <p>Aim for the hoop</p>
        <div id="score-board">0</div>
    </div>

    <script type="module">
        import * as THREE from 'three';

        // --- 1. ‡§¨‡•á‡§∏‡§ø‡§ï ‡§∏‡•á‡§ü‡§Ö‡§™ ---
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x20252f); // ‡§°‡§æ‡§∞‡•ç‡§ï ‡§¨‡•ç‡§≤‡•Ç ‡§ï‡•ã‡§∞‡•ç‡§ü
        scene.fog = new THREE.Fog(0x20252f, 10, 50);

        const camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 0.1, 100);
        camera.position.set(0, 5, 15); // ‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä ‡§ï‡•Ä ‡§™‡•ã‡§ú‡•Ä‡§∂‡§®
        camera.lookAt(0, 4, 0);

        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.shadowMap.enabled = true;
        document.body.appendChild(renderer.domElement);

        // --- 2. ‡§≤‡§æ‡§á‡§ü‡•ç‡§∏ ---
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(ambientLight);

        const spotLight = new THREE.SpotLight(0xffffff, 50);
        spotLight.position.set(5, 15, 10);
        spotLight.angle = Math.PI / 6;
        spotLight.castShadow = true;
        scene.add(spotLight);

        // --- 3. ‡§ï‡•ã‡§∞‡•ç‡§ü (Court) ‡§¨‡§®‡§æ‡§®‡§æ ---
        // ‡§ú‡§º‡§Æ‡•Ä‡§®
        const floorGeo = new THREE.PlaneGeometry(50, 50);
        const floorMat = new THREE.MeshStandardMaterial({ color: 0x334455, roughness: 0.1 });
        const floor = new THREE.Mesh(floorGeo, floorMat);
        floor.rotation.x = -Math.PI / 2;
        floor.receiveShadow = true;
        scene.add(floor);

        // --- 4. ‡§¨‡§æ‡§∏‡•ç‡§ï‡•á‡§ü‡§¨‡•â‡§≤ ‡§π‡•Ç‡§™ (The Net) ---
        const hoopGroup = new THREE.Group();
        
        // ‡§™‡•ã‡§≤ (Pole)
        const poleGeo = new THREE.CylinderGeometry(0.2, 0.2, 8, 16);
        const poleMat = new THREE.MeshStandardMaterial({ color: 0x888888, metalness: 0.5 });
        const pole = new THREE.Mesh(poleGeo, poleMat);
        pole.position.set(0, 4, -8);
        hoopGroup.add(pole);

        // ‡§¨‡•à‡§ï‡§¨‡•ã‡§∞‡•ç‡§° (Backboard)
        const boardGeo = new THREE.BoxGeometry(3, 2, 0.1);
        const boardMat = new THREE.MeshStandardMaterial({ color: 0xffffff });
        const board = new THREE.Mesh(boardGeo, boardMat);
        board.position.set(0, 7, -7.8);
        board.castShadow = true;
        hoopGroup.add(board);

        // ‡§∞‡§ø‡§Æ (The Ring) - ‡§Ø‡§π ‡§π‡§Æ‡§æ‡§∞‡§æ ‡§ü‡§æ‡§∞‡§ó‡•á‡§ü ‡§π‡•à
        const rimGeo = new THREE.TorusGeometry(0.8, 0.05, 16, 32);
        const rimMat = new THREE.MeshStandardMaterial({ color: 0xff4400 });
        const rim = new THREE.Mesh(rimGeo, rimMat);
        rim.rotation.x = Math.PI / 2;
        rim.position.set(0, 6, -6.5);
        hoopGroup.add(rim);

        // ‡§®‡•á‡§ü (‡§ú‡§æ‡§≤) - ‡§è‡§ï ‡§™‡§æ‡§∞‡§¶‡§∞‡•ç‡§∂‡•Ä ‡§∏‡§ø‡§≤‡•á‡§Ç‡§°‡§∞
        const netGeo = new THREE.CylinderGeometry(0.8, 0.5, 1, 32, 4, true);
        const netMat = new THREE.MeshBasicMaterial({ 
            color: 0xffffff, wireframe: true, transparent: true, opacity: 0.5 
        });
        const net = new THREE.Mesh(netGeo, netMat);
        net.position.set(0, 5.5, -6.5);
        hoopGroup.add(net);

        scene.add(hoopGroup);

        // --- 5. ‡§¨‡•â‡§≤ ‡§î‡§∞ ‡§´‡§ø‡§ú‡§ø‡§ï‡•ç‡§∏ ‡§≤‡•â‡§ú‡§ø‡§ï ---
        const balls = []; // ‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§® ‡§™‡§∞ ‡§Æ‡•å‡§ú‡•Ç‡§¶ ‡§¨‡•â‡§≤‡•ç‡§∏
        const ballGeo = new THREE.SphereGeometry(0.5, 32, 32);
        const ballMat = new THREE.MeshStandardMaterial({ 
            color: 0xff6600, roughness: 0.4, metalness: 0.1 
        });

        // ‡§∏‡•ç‡§ï‡•ã‡§∞‡§ø‡§Ç‡§ó ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ
        let score = 0;
        const scoreEl = document.getElementById('score-board');
        const particles = []; // ‡§∏‡•á‡§≤‡§ø‡§¨‡•ç‡§∞‡•á‡§∂‡§® ‡§ï‡•á ‡§≤‡§ø‡§è

        // --- 6. ‡§¨‡•â‡§≤ ‡§´‡•á‡§Ç‡§ï‡§®‡•á ‡§ï‡§æ ‡§´‡§Ç‡§ï‡•ç‡§∂‡§® ---
        function shootBall(event) {
            // A. ‡§ü‡§ö ‡§á‡§´‡•á‡§ï‡•ç‡§ü (Ripple) UI ‡§™‡§∞ ‡§¨‡§®‡§æ‡§®‡§æ
            const ripple = document.createElement('div');
            ripple.className = 'ripple';
            ripple.style.width = '50px'; ripple.style.height = '50px';
            ripple.style.left = `${event.clientX - 25}px`;
            ripple.style.top = `${event.clientY - 25}px`;
            document.body.appendChild(ripple);
            setTimeout(() => ripple.remove(), 600);

            // B. 3D ‡§¨‡•â‡§≤ ‡§¨‡§®‡§æ‡§®‡§æ
            const ball = new THREE.Mesh(ballGeo, ballMat);
            ball.castShadow = true;
            
            // ‡§¨‡•â‡§≤ ‡§ï‡•Ä ‡§∂‡•Å‡§∞‡•Å‡§Ü‡§§‡•Ä ‡§∏‡•ç‡§•‡§ø‡§§‡§ø (‡§ï‡•à‡§Æ‡§∞‡•á ‡§ï‡•á ‡§•‡•ã‡§°‡§º‡§æ ‡§®‡•Ä‡§ö‡•á)
            ball.position.set(0, 4, 12);
            
            // C. ‡§®‡§ø‡§∂‡§æ‡§®‡§æ ‡§≤‡§ó‡§æ‡§®‡§æ (Physics Velocity)
            // ‡§π‡§Æ ‡§Æ‡§æ‡§â‡§∏ ‡§ï‡•Ä ‡§™‡•ã‡§ú‡•Ä‡§∂‡§® ‡§ï‡•á ‡§π‡§ø‡§∏‡§æ‡§¨ ‡§∏‡•á ‡§•‡•ã‡§°‡§º‡§æ ‡§è‡§Ç‡§ó‡§≤ ‡§¨‡§¶‡§≤‡•á‡§Ç‡§ó‡•á
            const mouseX = (event.clientX / window.innerWidth) * 2 - 1;
            const mouseY = -(event.clientY / window.innerHeight) * 2 + 1;

            // ‡§µ‡•á‡§≤‡•ã‡§∏‡§ø‡§ü‡•Ä ‡§µ‡•á‡§ï‡•ç‡§ü‡§∞ (‡§∞‡§´‡§º‡•ç‡§§‡§æ‡§∞ ‡§î‡§∞ ‡§¶‡§ø‡§∂‡§æ)
            // x: ‡§Æ‡§æ‡§â‡§∏ ‡§ï‡•á ‡§π‡§ø‡§∏‡§æ‡§¨ ‡§∏‡•á ‡§≤‡•á‡§´‡•ç‡§ü/‡§∞‡§æ‡§á‡§ü
            // y: ‡§π‡§Æ‡•á‡§∂‡§æ ‡§ä‡§™‡§∞ ‡§ï‡•Ä ‡§§‡§∞‡§´ ‡§•‡•ã‡§°‡§º‡§æ ‡§∏‡§æ (Throw arc)
            // z: ‡§π‡§Æ‡•á‡§∂‡§æ ‡§®‡•á‡§ü ‡§ï‡•Ä ‡§§‡§∞‡§´ (Negative Z)
            const velocity = new THREE.Vector3(mouseX * 2, 6 + (mouseY * 2), -15);
            
            // ‡§¨‡•â‡§≤ ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü ‡§Æ‡•á‡§Ç ‡§°‡•á‡§ü‡§æ ‡§∏‡•á‡§µ ‡§ï‡§∞‡•á‡§Ç
            ball.userData = { velocity: velocity, active: true, scored: false };
            
            scene.add(ball);
            balls.push(ball);
        }

        // --- 7. ‡§™‡§æ‡§∞‡•ç‡§ü‡•Ä‡§ï‡§≤‡•ç‡§∏ (Score ‡§π‡•ã‡§®‡•á ‡§™‡§∞) ---
        function createConfetti(x, y, z) {
            const colors = [0xff0000, 0x00ff00, 0x0000ff, 0xffff00];
            for (let i = 0; i < 30; i++) {
                const geo = new THREE.BoxGeometry(0.1, 0.1, 0.1);
                const mat = new THREE.MeshBasicMaterial({ color: colors[Math.floor(Math.random()*colors.length)] });
                const part = new THREE.Mesh(geo, mat);
                part.position.set(x, y, z);
                
                // ‡§∞‡•à‡§Ç‡§°‡§Æ ‡§´‡•à‡§≤‡§æ‡§µ
                part.userData = {
                    velocity: new THREE.Vector3(
                        (Math.random() - 0.5) * 5,
                        (Math.random() - 0.5) * 5,
                        (Math.random() - 0.5) * 5
                    )
                };
                scene.add(part);
                particles.push(part);
            }
        }

        // --- 8. ‡§ó‡•á‡§Æ ‡§≤‡•Ç‡§™ (Animation) ---
        function animate() {
            requestAnimationFrame(animate);

            // A. ‡§∏‡§≠‡•Ä ‡§¨‡•â‡§≤‡•ç‡§∏ ‡§ï‡•ã ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç
            for (let i = balls.length - 1; i >= 0; i--) {
                const b = balls[i];
                const v = b.userData.velocity;

                if (b.userData.active) {
                    // ‡§¨‡•â‡§≤ ‡§ï‡•ã ‡§Æ‡•Ç‡§µ ‡§ï‡§∞‡•á‡§Ç
                    b.position.addScaledVector(v, 0.03); // 0.03 ‡§ü‡§æ‡§á‡§Æ ‡§°‡•á‡§≤‡•ç‡§ü‡§æ ‡§π‡•à

                    // ‡§ó‡•ç‡§∞‡•á‡§µ‡§ø‡§ü‡•Ä (Gravity) - Y velocity ‡§ï‡§Æ ‡§π‡•ã‡§§‡•Ä ‡§ú‡§æ‡§è‡§ó‡•Ä
                    v.y -= 0.25; 

                    // ‡§ú‡§º‡§Æ‡•Ä‡§® ‡§∏‡•á ‡§ü‡§ï‡§∞‡§æ‡§®‡§æ (Bounce)
                    if (b.position.y <= 0.5) {
                        b.position.y = 0.5;
                        v.y *= -0.6; // ‡§¨‡§æ‡§â‡§Ç‡§∏ ‡§π‡•ã‡§®‡•á ‡§™‡§∞ ‡§è‡§®‡§∞‡•ç‡§ú‡•Ä ‡§ï‡§Æ ‡§π‡•ã‡§ó‡•Ä
                        v.x *= 0.9;  // ‡§´‡•ç‡§∞‡§ø‡§ï‡•ç‡§∂‡§®
                        v.z *= 0.9;

                        // ‡§Ö‡§ó‡§∞ ‡§¨‡•â‡§≤ ‡§¨‡§π‡•Å‡§§ ‡§ß‡•Ä‡§Æ‡•Ä ‡§π‡•ã ‡§ó‡§à, ‡§§‡•ã ‡§â‡§∏‡•á ‡§π‡§ü‡§æ ‡§¶‡•á‡§Ç
                        if (Math.abs(v.y) < 0.5) b.userData.active = false;
                    }

                    // ‡§¨‡•Ä. ‡§ï‡•ç‡§Ø‡§æ ‡§ó‡•ã‡§≤ ‡§π‡•Å‡§Ü? (Collision Detection with Hoop)
                    // ‡§π‡•Ç‡§™ ‡§ï‡•Ä ‡§™‡•ã‡§ú‡•Ä‡§∂‡§® (0, 6, -6.5) ‡§π‡•à
                    const dist = b.position.distanceTo(new THREE.Vector3(0, 6, -6.5));
                    
                    if (dist < 1 && !b.userData.scored && v.y < 0) {
                        // ‡§ó‡•ã‡§≤! (‡§∏‡§ø‡§∞‡•ç‡§´ ‡§§‡§¨ ‡§ú‡§¨ ‡§¨‡•â‡§≤ ‡§ä‡§™‡§∞ ‡§∏‡•á ‡§®‡•Ä‡§ö‡•á ‡§Ü ‡§∞‡§π‡•Ä ‡§π‡•ã v.y < 0)
                        score++;
                        scoreEl.innerText = score;
                        scoreEl.style.color = '#00ff00';
                        setTimeout(() => scoreEl.style.color = '#ffeb3b', 200);
                        
                        b.userData.scored = true;
                        createConfetti(0, 6, -6.5); // ‡§Ü‡§§‡§ø‡§∂‡§¨‡§æ‡§ú‡•Ä
                    }
                }
                
                // ‡§¨‡•â‡§≤ ‡§Ö‡§ó‡§∞ ‡§¨‡§π‡•Å‡§§ ‡§¶‡•Ç‡§∞ ‡§ö‡§≤‡•Ä ‡§ó‡§à, ‡§§‡•ã ‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§∏‡•á ‡§π‡§ü‡§æ ‡§¶‡•á‡§Ç
                if (b.position.y < -5 || b.position.z < -20) {
                    scene.remove(b);
                    balls.splice(i, 1);
                }
            }

            // B. ‡§™‡§æ‡§∞‡•ç‡§ü‡•Ä‡§ï‡§≤‡•ç‡§∏ ‡§Ö‡§™‡§°‡•á‡§ü
            for (let i = particles.length - 1; i >= 0; i--) {
                const p = particles[i];
                p.position.addScaledVector(p.userData.velocity, 0.05);
                p.scale.multiplyScalar(0.95); // ‡§ß‡•Ä‡§∞‡•á ‡§ß‡•Ä‡§∞‡•á ‡§õ‡•ã‡§ü‡§æ ‡§π‡•ã
                if (p.scale.x < 0.01) {
                    scene.remove(p);
                    particles.splice(i, 1);
                }
            }

            renderer.render(scene, camera);
        }

        // ‡§á‡§µ‡•á‡§Ç‡§ü ‡§≤‡§ø‡§∏‡§®‡§∞
        window.addEventListener('click', shootBall);
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        animate();
    </script>
</body>
</html>